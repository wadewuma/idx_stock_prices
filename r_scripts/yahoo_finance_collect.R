# obtain all stock prices data from yahoo! finance at once

setwd('C:\\your\\path\\here')

# install.packages('BatchGetSymbols')
# install.packages('rvest')
# install.packages('xml2')

library(BatchGetSymbols)
library(rvest)
library(xml2)

# create dictionary that consists all of companies listed in Indonesia Stock Exchange
ticker <- c('AALI.JK',
            'ABBA.JK',
            'ABDA.JK',
            'ABMM.JK',
            'ACES.JK',
            'ACST.JK',
            'ADES.JK',
            'ADHI.JK',
            'ADMF.JK',
            'ADMG.JK',
            'ADRO.JK',
            'AGII.JK',
            'AGRO.JK',
            'AGRS.JK',
            'AHAP.JK',
            'AIMS.JK',
            'AIRJ.JK',
            'AISA.JK',
            'AKKU.JK',
            'AKPI.JK',
            'AKRA.JK',
            'AKSI.JK',
            'ALDO.JK',
            'ALKA.JK',
            'ALMI.JK',
            'ALTO.JK',
            'AMAG.JK',
            'AMFG.JK',
            'AMIN.JK',
            'AMRT.JK',
            'ANJT.JK',
            'ANTM.JK',
            'APAI.JK',
            'APEX.JK',
            'APIA.JK',
            'APIC.JK',
            'APII.JK',
            'APLI.JK',
            'APLN.JK',
            'APOL.JK',
            'ARGO.JK',
            'ARII.JK',
            'ARMY.JK',
            'ARNA.JK',
            'ARTA.JK',
            'ARTI.JK',
            'ARTO.JK',
            'ASBI.JK',
            'ASDF.JK',
            'ASDM.JK',
            'ASGR.JK',
            'ASII.JK',
            'ASJT.JK',
            'ASMI.JK',
            'ASRI.JK',
            'ASRM.JK',
            'ASSA.JK',
            'ATIC.JK',
            'ATPK.JK',
            'AUTO.JK',
            'BABP.JK',
            'BACA.JK',
            'BAFI.JK',
            'BAJA.JK',
            'BALI.JK',
            'BAPA.JK',
            'BATA.JK',
            'BAYU.JK',
            'BBCA.JK',
            'BBHI.JK',
            'BBIA.JK',
            'BBKE.JK',
            'BBKP.JK',
            'BBLD.JK',
            'BBMD.JK',
            'BBMI.JK',
            'BBNI.JK',
            'BBNP.JK',
            'BBRI.JK',
            'BBRK.JK',
            'BBRM.JK',
            'BBSY.JK',
            'BBTN.JK',
            'BBYB.JK',
            'BCAF.JK',
            'BCAP.JK',
            'BCIC.JK',
            'BCIP.JK',
            'BDKI.JK',
            'BDMN.JK',
            'BEKS.JK',
            'BELL.JK',
            'BEST.JK',
            'BEXI.JK',
            'BFIN.JK',
            'BGTG.JK',
            'BHIT.JK',
            'BIIF.JK',
            'BIKA.JK',
            'BIMA.JK',
            'BIMF.JK',
            'BINA.JK',
            'BIPI.JK',
            'BIPP.JK',
            'BIRD.JK',
            'BISI.JK',
            'BJBR.JK',
            'BJTG.JK',
            'BJTM.JK',
            'BKDP.JK',
            'BKSL.JK',
            'BKSW.JK',
            'BLAM.JK',
            'BLTA.JK',
            'BLTZ.JK',
            'BMAS.JK',
            'BMLK.JK',
            'BMRI.JK',
            'BMSR.JK',
            'BMTP.JK',
            'BMTR.JK',
            'BNBA.JK',
            'BNBR.JK',
            'BNGA.JK',
            'BNII.JK',
            'BNLI.JK',
            'BNTT.JK',
            'BOGA.JK',
            'BOLT.JK',
            'BORN.JK',
            'BOSS.JK',
            'BPFI.JK',
            'BPII.JK',
            'BPTR.JK',
            'BRAM.JK',
            'BRAP.JK',
            'BRIS.JK',
            'BRMS.JK',
            'BRNA.JK',
            'BRPT.JK',
            'BSBR.JK',
            'BSDE.JK',
            'BSEC.JK',
            'BSIM.JK',
            'BSLT.JK',
            'BSMT.JK',
            'BSSB.JK',
            'BSSR.JK',
            'BSWD.JK',
            'BTEK.JK',
            'BTEL.JK',
            'BTON.JK',
            'BTPN.JK',
            'BTPS.JK',
            'BUDI.JK',
            'BULL.JK',
            'BUMI.JK',
            'BUVA.JK',
            'BVIC.JK',
            'BWPT.JK',
            'BYAN.JK',
            'CAMP.JK',
            'CANI.JK',
            'CARS.JK',
            'CASA.JK',
            'CASS.JK',
            'CEKA.JK',
            'CENT.JK',
            'CFIN.JK',
            'CINT.JK',
            'CITA.JK',
            'CKRA.JK',
            'CLEO.JK',
            'CLPI.JK',
            'CMNP.JK',
            'CMPP.JK',
            'CNAF.JK',
            'CNKO.JK',
            'CNTX.JK',
            'COWL.JK',
            'CPIN.JK',
            'CPRO.JK',
            'CSAP.JK',
            'CSIS.JK',
            'CSUL.JK',
            'CTBN.JK',
            'CTRA.JK',
            'CTRR.JK',
            'CTTH.JK',
            'DART.JK',
            'DAYA.JK',
            'DEFI.JK',
            'DEWA.JK',
            'DFAM.JK',
            'DGIK.JK',
            'DILD.JK',
            'DKFT.JK',
            'DLTA.JK',
            'DMAS.JK',
            'DNAR.JK',
            'DNET.JK',
            'DNRK.JK',
            'DOID.JK',
            'DPNS.JK',
            'DPUM.JK',
            'DSFI.JK',
            'DSNG.JK',
            'DSSA.JK',
            'DUTI.JK',
            'DVLA.JK',
            'DWGL.JK',
            'DYAN.JK',
            'ECII.JK',
            'EKAD.JK',
            'ELSA.JK',
            'ELTY.JK',
            'EMDE.JK',
            'EMTK.JK',
            'ENRG.JK',
            'EPMT.JK',
            'ERAA.JK',
            'ERTX.JK',
            'ESSA.JK',
            'ESTI.JK',
            'ETWA.JK',
            'EXCL.JK',
            'FAST.JK',
            'FASW.JK',
            'FIFA.JK',
            'FINN.JK',
            'FIRE.JK',
            'FISH.JK',
            'FMII.JK',
            'FORU.JK',
            'FORZ.JK',
            'FPNI.JK',
            'FREN.JK',
            'GAMA.JK',
            'GDST.JK',
            'GDYR.JK',
            'GEMA.JK',
            'GEMS.JK',
            'GGRM.JK',
            'GHON.JK',
            'GIAA.JK',
            'GJTL.JK',
            'GLOB.JK',
            'GMCW.JK',
            'GMFI.JK',
            'GMTD.JK',
            'GOLD.JK',
            'GOLL.JK',
            'GPRA.JK',
            'GREN.JK',
            'GSMF.JK',
            'GTBO.JK',
            'GWSA.JK',
            'GZCO.JK',
            'HADE.JK',
            'HDFA.JK',
            'HDTX.JK',
            'HEAL.JK',
            'HELI.JK',
            'HERO.JK',
            'HEXA.JK',
            'HITS.JK',
            'HMSP.JK',
            'HOKI.JK',
            'HOME.JK',
            'HOTL.JK',
            'HRTA.JK',
            'HRUM.JK',
            'IATA.JK',
            'IBFN.JK',
            'IBST.JK',
            'ICBP.JK',
            'ICON.JK',
            'IDPR.JK',
            'IGAR.JK',
            'IIFF.JK',
            'IIKP.JK',
            'IKAI.JK',
            'IKBI.JK',
            'IMAS.JK',
            'IMAT.JK',
            'IMFI.JK',
            'IMJS.JK',
            'IMPC.JK',
            'INAF.JK',
            'INAI.JK',
            'INCI.JK',
            'INCO.JK',
            'INDF.JK',
            'INDR.JK',
            'INDS.JK',
            'INDX.JK',
            'INDY.JK',
            'INKP.JK',
            'INPC.JK',
            'INPP.JK',
            'INPS.JK',
            'INRU.JK',
            'INTA.JK',
            'INTD.JK',
            'INTP.JK',
            'IPCC.JK',
            'IPCM.JK',
            'IPOL.JK',
            'ISAT.JK',
            'ISSP.JK',
            'ITMA.JK',
            'ITMG.JK',
            'ITTG.JK',
            'JAWA.JK',
            'JECC.JK',
            'JGLE.JK',
            'JIHD.JK',
            'JKON.JK',
            'JKSW.JK',
            'JMAS.JK',
            'JPFA.JK',
            'JPRS.JK',
            'JRPT.JK',
            'JSKY.JK',
            'JSMR.JK',
            'JSPT.JK',
            'JTPE.JK',
            'KAEF.JK',
            'KAII.JK',
            'KARW.JK',
            'KBLI.JK',
            'KBLM.JK',
            'KBLV.JK',
            'KBRI.JK',
            'KDSI.JK',
            'KEHA.JK',
            'KIAS.JK',
            'KICI.JK',
            'KIJA.JK',
            'KINO.JK',
            'KIOS.JK',
            'KKGI.JK',
            'KLBF.JK',
            'KMTR.JK',
            'KOBX.JK',
            'KOIN.JK',
            'KONI.JK',
            'KOPI.JK',
            'KPAL.JK',
            'KPIG.JK',
            'KRAH.JK',
            'KRAS.JK',
            'KREN.JK',
            'LAPD.JK',
            'LCGP.JK',
            'LCKM.JK',
            'LEAD.JK',
            'LINK.JK',
            'LION.JK',
            'LMAS.JK',
            'LMPI.JK',
            'LMSH.JK',
            'LPCK.JK',
            'LPGI.JK',
            'LPIN.JK',
            'LPKR.JK',
            'LPLI.JK',
            'LPPF.JK',
            'LPPS.JK',
            'LRNA.JK',
            'LSIP.JK',
            'LTLS.JK',
            'MABA.JK',
            'MAGP.JK',
            'MAIN.JK',
            'MAMI.JK',
            'MAPA.JK',
            'MAPB.JK',
            'MAPI.JK',
            'MARI.JK',
            'MARK.JK',
            'MASA.JK',
            'MAYA.JK',
            'MBAP.JK',
            'MBSS.JK',
            'MBTO.JK',
            'MCAS.JK',
            'MCOR.JK',
            'MDIA.JK',
            'MDKA.JK',
            'MDKI.JK',
            'MDLN.JK',
            'MDRN.JK',
            'MEDC.JK',
            'MEDP.JK',
            'MEGA.JK',
            'MERK.JK',
            'META.JK',
            'MFIN.JK',
            'MFMI.JK',
            'MGNA.JK',
            'MGRO.JK',
            'MICE.JK',
            'MIDI.JK',
            'MIKA.JK',
            'MINA.JK',
            'MIRA.JK',
            'MITI.JK',
            'MKNT.JK',
            'MKPI.JK',
            'MLBI.JK',
            'MLIA.JK',
            'MLJK.JK',
            'MLPL.JK',
            'MLPT.JK',
            'MMLP.JK',
            'MNCN.JK',
            'MORA.JK',
            'MPMX.JK',
            'MPOW.JK',
            'MPPA.JK',
            'MRAT.JK',
            'MREI.JK',
            'MSIN.JK',
            'MSKY.JK',
            'MTDL.JK',
            'MTFN.JK',
            'MTLA.JK',
            'MTRA.JK',
            'MTSM.JK',
            'MTWI.JK',
            'MYOH.JK',
            'MYOR.JK',
            'MYRX.JK',
            'MYTX.JK',
            'NAGA.JK',
            'NASA.JK',
            'NELY.JK',
            'NFCX.JK',
            'NICK.JK',
            'NIKL.JK',
            'NIPS.JK',
            'NIRO.JK',
            'NISP.JK',
            'NOBU.JK',
            'NRCA.JK',
            'NUSA.JK',
            'OASA.JK',
            'OCAP.JK',
            'OKAS.JK',
            'OMRE.JK',
            'OTMA.JK',
            'PADI.JK',
            'PALM.JK',
            'PANR.JK',
            'PANS.JK',
            'PBID.JK',
            'PBRX.JK',
            'PBSA.JK',
            'PCAR.JK',
            'PDES.JK',
            'PEGE.JK',
            'PGAS.JK',
            'PGLI.JK',
            'PICO.JK',
            'PIGN.JK',
            'PIHC.JK',
            'PIKI.JK',
            'PJAA.JK',
            'PKPK.JK',
            'PLAS.JK',
            'PLIN.JK',
            'PNBN.JK',
            'PNBS.JK',
            'PNIN.JK',
            'PNLF.JK',
            'PNMP.JK',
            'PNSE.JK',
            'POLL.JK',
            'POLY.JK',
            'POOL.JK',
            'PORT.JK',
            'POWR.JK',
            'PPGD.JK',
            'PPKT.JK',
            'PPLN.JK',
            'PPNX.JK',
            'PPRE.JK',
            'PPRO.JK',
            'PRAS.JK',
            'PRDA.JK',
            'PRIM.JK',
            'PRTL.JK',
            'PSAB.JK',
            'PSDN.JK',
            'PSKT.JK',
            'PSSI.JK',
            'PTBA.JK',
            'PTHK.JK',
            'PTIS.JK',
            'PTPP.JK',
            'PTRO.JK',
            'PTSN.JK',
            'PTSP.JK',
            'PUDP.JK',
            'PWON.JK',
            'PYFA.JK',
            'PZZA.JK',
            'RAJA.JK',
            'RALS.JK',
            'RANC.JK',
            'RBMS.JK',
            'RDTX.JK',
            'RELI.JK',
            'RICY.JK',
            'RIGS.JK',
            'RIMO.JK',
            'RISE.JK',
            'RMBA.JK',
            'RODA.JK',
            'ROTI.JK',
            'RUIS.JK',
            'SAFE.JK',
            'SAME.JK',
            'SANF.JK',
            'SCBD.JK',
            'SCCO.JK',
            'SCMA.JK',
            'SCPI.JK',
            'SDMU.JK',
            'SDPC.JK',
            'SDRA.JK',
            'SGRO.JK',
            'SHID.JK',
            'SHIP.JK',
            'SIAP.JK',
            'SIDO.JK',
            'SILO.JK',
            'SIMA.JK',
            'SIMP.JK',
            'SIPD.JK',
            'SKLT.JK',
            'SKYB.JK',
            'SMAR.JK',
            'SMBR.JK',
            'SMCB.JK',
            'SMDM.JK',
            'SMDR.JK',
            'SMFP.JK',
            'SMGR.JK',
            'SMII.JK',
            'SMMA.JK',
            'SMMF.JK',
            'SMMT.JK',
            'SMRA.JK',
            'SMRU.JK',
            'SMSM.JK',
            'SOCI.JK',
            'SONA.JK',
            'SPMA.JK',
            'SPTO.JK',
            'SQMI.JK',
            'SRAJ.JK',
            'SRIL.JK',
            'SRSN.JK',
            'SRTG.JK',
            'SSIA.JK',
            'SSMM.JK',
            'SSMS.JK',
            'SSTM.JK',
            'STAR.JK',
            'STTP.JK',
            'SUGI.JK',
            'SULI.JK',
            'SUPR.JK',
            'SWAT.JK',
            'TAFS.JK',
            'TAMU.JK',
            'TARA.JK',
            'TAXI.JK',
            'TBIG.JK',
            'TBLA.JK',
            'TBMS.JK',
            'TCID.JK',
            'TCPI.JK',
            'TDPM.JK',
            'TELE.JK',
            'TFCO.JK',
            'TGKA.JK',
            'TGRA.JK',
            'TIFA.JK',
            'TINS.JK',
            'TIRA.JK',
            'TIRT.JK',
            'TKIM.JK',
            'TLKM.JK',
            'TMAS.JK',
            'TMPI.JK',
            'TMPO.JK',
            'TNCA.JK',
            'TOBA.JK',
            'TOPS.JK',
            'TOTL.JK',
            'TOTO.JK',
            'TOWR.JK',
            'TPIA.JK',
            'TPMA.JK',
            'TPNI.JK',
            'TRAC.JK',
            'TRAM.JK',
            'TRIL.JK',
            'TRIM.JK',
            'TRIO.JK',
            'TRIS.JK',
            'TRST.JK',
            'TRUB.JK',
            'TRUK.JK',
            'TRUS.JK',
            'TSPC.JK',
            'TUFI.JK',
            'TUGU.JK',
            'TURI.JK',
            'ULTJ.JK',
            'UNIC.JK',
            'UNIT.JK',
            'UNSP.JK',
            'UNTR.JK',
            'UNVR.JK',
            'VICO.JK',
            'VINS.JK',
            'VIVA.JK',
            'VOKS.JK',
            'VRNA.JK',
            'WAPO.JK',
            'WEGE.JK',
            'WEHA.JK',
            'WICO.JK',
            'WIIM.JK',
            'WIKA.JK',
            'WINS.JK',
            'WOMF.JK',
            'WOOD.JK',
            'WSBP.JK',
            'WSKT.JK',
            'WTON.JK',
            'YPAS.JK',
            'YULE.JK',
            'ZBRA.JK',
            'ZINC.JK'
)

# set time period
n <- as.numeric(as.Date(Sys.Date())-as.Date("2018-01-01")) # year-to-date
first_date <- Sys.Date()-n # current date minus total days in n
last_date <- Sys.Date() # current date

# get all publicly listed companies
df <- BatchGetSymbols(tickers = ticker,
                      first.date = first_date,
                      last.date = last_date)

# after finishing the download, create a data frame that consists all of the companies
df = data.frame(df$df.tickers)

# save in csv format so it can be used in the future
write.csv(df, file = 'idx_yahoo_finance.csv')
